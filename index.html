<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>京都・大阪冬日旅</title>
    
    <!-- 載入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 載入 React 和 ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 載入 Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f3f4f6;
        }

        /* 自定義捲軸 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

        @media print {
            @page { margin: 5mm; size: A4; }
            body { background-color: white; -webkit-print-color-adjust: exact; }
            .no-print { display: none !important; }
            .print-break { break-inside: avoid; }
            /* 列印時強制背景色 */
            .bg-slate-900 { background-color: #0f172a !important; color: white !important; }
            .bg-indigo-50 { background-color: #eef2ff !important; }
            .text-indigo-400 { color: #818cf8 !important; }
        }
    </style>
</head>
<body>
    
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- SVG Icons ---
        const Icons = {
            MapPin: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>,
            Calendar: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
            Plus: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
            Trash2: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>,
            ExternalLink: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
            Save: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
            ShoppingBag: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>,
            Coffee: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>,
            Thermometer: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z"/></svg>,
            Train: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="6" y="3" width="12" height="13" rx="2"/><path d="m9 8 2 2 2-2"/><path d="M15 8V4"/><path d="M9 4v4"/><path d="M10 21V19a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v2"/><path d="M7 16h10"/></svg>,
            FileText: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>,
            Sun: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>,
            Moon: ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>,
        };

        const INITIAL_DAYS = [
          {
            id: 1,
            date: '2/8 (六)',
            weather: 'sunny',
            temperature: '-1°C - 7°C',
            transport: 'CI156 / 利木津巴士',
            ticketType: 'Ticket',
            accommodation: '素居旅舍',
            schedule: [
              { id: 1, time: '08:05', activity: '桃園機場起飛 (CI156)', note: '5:00 派車出發', link: '' },
              { id: 2, time: '11:35', activity: '抵達關西機場 T1', note: '從 C 出口搭利木津巴士', link: '' },
              { id: 3, time: '14:00', activity: '京都車站用餐', note: '拉麵小路', link: '' },
              { id: 4, time: '15:00', activity: '飯店 Check-in', note: '素居旅舍', link: 'https://guesthousesoi.com/what-we-provide-tw/' },
            ],
            shopping: [{ id: 1, name: 'Porta 地下街雜貨', location: '流行服飾與藥妝' }],
            food: { wishlist: [], breakfast: '', lunch: '', dinner: '' },
            notes: '本地自動存檔中\n抵達 T1 1樓大廳後，從 C 出口走出去搭巴士最快。'
          },
          {
            id: 2,
            date: '2/9 (日)',
            weather: 'sunny',
            temperature: '2°C - 9°C',
            transport: '京阪電車',
            ticketType: 'IC Card',
            accommodation: '素居旅舍',
            schedule: [
              { id: 1, time: '09:00', activity: '前往伏見桃山', note: '酒藏 + 老街', link: '' },
              { id: 2, time: '13:30', activity: '前往宇治', note: '平等院 + 抹茶', link: '' },
            ],
            shopping: [],
            food: { wishlist: [], breakfast: '', lunch: '', dinner: '' },
            notes: '京阪電車轉一次車約20分鐘。'
          },
          {id: 3, date: '2/10 (一)', weather: 'cloudy', temperature: '4°C - 11°C', transport: 'E-bike', ticketType: 'Ticket', accommodation: '素居旅舍', schedule: [], shopping: [], food: { wishlist: [], breakfast: '', lunch: '', dinner: '' }, notes: ''},
          {id: 4, date: '2/11 (二)', weather: 'sunny', temperature: '1°C - 8°C', transport: '租車自駕', ticketType: 'Ticket', accommodation: '美山周邊', schedule: [], shopping: [], food: { wishlist: [], breakfast: '', lunch: '', dinner: '' }, notes: ''},
          {id: 5, date: '2/12 (三)', weather: 'sunny', temperature: '3°C - 9°C', transport: '自駕/JR', ticketType: 'IC Card', accommodation: '大阪市區', schedule: [], shopping: [], food: { wishlist: [], breakfast: '', lunch: '', dinner: '' }, notes: ''},
          {id: 6, date: '2/13 (四)', weather: 'sunny', temperature: '4°C - 12°C', transport: '新幹線', ticketType: 'Ticket', accommodation: '大阪市區', schedule: [], shopping: [], food: { wishlist: [], breakfast: '', lunch: '', dinner: '' }, notes: ''},
          {id: 7, date: '2/14 (五)', weather: 'sunny', temperature: '5°C - 13°C', transport: '南海電鐵', ticketType: 'Ticket', accommodation: '溫暖的家', schedule: [], shopping: [], food: { wishlist: [], breakfast: '', lunch: '', dinner: '' }, notes: ''},
        ];

        function App() {
            const [days, setDays] = useState(INITIAL_DAYS);
            const [activeDayId, setActiveDayId] = useState(1);
            const [isPreviewMode, setIsPreviewMode] = useState(false);

            useEffect(() => {
                const savedData = localStorage.getItem('kyoto_trip_data_v4');
                if (savedData) { try { setDays(JSON.parse(savedData)); } catch (e) { console.error(e); } }
            }, []);

            useEffect(() => {
                localStorage.setItem('kyoto_trip_data_v4', JSON.stringify(days));
            }, [days]);

            const activeDay = days.find(d => d.id === activeDayId) || days[0];

            const handleExportText = () => {
                let text = `京都七日遊行程表\n\n`;
                days.forEach(day => {
                    text += `【${day.date}】\n氣溫: ${day.temperature} | 交通: ${day.transport}\n`;
                    text += `備註: ${day.notes}\n`;
                    day.schedule.forEach(item => {
                        text += `${item.time} ${item.activity} (${item.note || ''})\n`;
                    });
                    text += `\n`;
                });
                const blob = new Blob([text], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = '京都行程.txt';
                a.click();
            };

            const updateDay = (id, field, value) => {
                setDays(prev => prev.map(d => d.id === id ? { ...d, [field]: value } : d));
            };

            const updateSchedule = (dayId, schedule) => {
                setDays(prev => prev.map(d => d.id === dayId ? { ...d, schedule } : d));
            };

            const updateShopping = (dayId, shopping) => {
                setDays(prev => prev.map(d => d.id === dayId ? { ...d, shopping } : d));
            };

            return (
                <div className="min-h-screen pb-10">
                    {/* Header (Purple Gradient) */}
                    {!isPreviewMode && (
                        <div className="bg-indigo-900 text-white shadow-lg no-print">
                            <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                                <div>
                                    <h1 className="text-2xl font-bold flex items-center gap-2">
                                        <Icons.MapPin className="text-pink-400" /> 京都・大阪冬日旅
                                    </h1>
                                    <p className="text-indigo-300 text-xs mt-1 tracking-wider">個人專屬編輯地圖</p>
                                </div>
                                <button onClick={() => { setIsPreviewMode(true); setTimeout(() => window.print(), 100); }} 
                                    className="bg-white text-indigo-900 px-4 py-2 rounded-full text-sm font-bold shadow hover:bg-indigo-50 flex items-center gap-2 transition-transform hover:scale-105">
                                    <Icons.FileText className="w-4 h-4" /> 匯出清單
                                </button>
                            </div>
                            
                            {/* Tabs Navigation */}
                            <div className="max-w-7xl mx-auto px-4 mt-4 overflow-x-auto">
                                <div className="flex space-x-6 border-b border-indigo-700/50">
                                    {days.map(day => (
                                        <button
                                            key={day.id}
                                            onClick={() => setActiveDayId(day.id)}
                                            className={`pb-3 px-2 text-sm font-medium transition-colors relative whitespace-nowrap
                                                ${activeDayId === day.id ? 'text-white' : 'text-indigo-400 hover:text-indigo-200'}`}
                                        >
                                            Day {day.id} <span className="text-xs opacity-70 ml-1">{day.date.split(' ')[0]}</span>
                                            {activeDayId === day.id && (
                                                <div className="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-pink-500 to-indigo-400 rounded-t-full"></div>
                                            )}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* 預覽模式Header */}
                    {isPreviewMode && (
                        <div className="bg-slate-800 text-white p-3 text-center no-print sticky top-0 z-50 shadow-xl">
                            <span className="mr-4 font-bold">預覽模式</span>
                            <button onClick={() => setIsPreviewMode(false)} className="px-4 py-1 bg-slate-600 rounded-full text-sm hover:bg-slate-500 mr-2">返回編輯</button>
                            <button onClick={() => window.print()} className="px-4 py-1 bg-emerald-500 rounded-full text-sm hover:bg-emerald-400 font-bold">確認列印</button>
                        </div>
                    )}

                    {/* Main Content Grid */}
                    <div className="max-w-7xl mx-auto p-4 md:p-6 lg:p-8">
                        {(isPreviewMode ? days : [activeDay]).map((day) => (
                            <div key={day.id} className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-12 print-break">
                                
                                {/* Left Column: Schedule (2/3 width) */}
                                <div className="lg:col-span-2 space-y-6">
                                    <div className="bg-white rounded-3xl shadow-sm border border-slate-100 p-6 md:p-8">
                                        <div className="flex justify-between items-center mb-8">
                                            <h2 className="text-lg font-bold text-slate-700 flex items-center gap-2">
                                                <div className="w-8 h-8 rounded-lg bg-indigo-100 flex items-center justify-center text-indigo-600">
                                                    <Icons.Calendar className="w-5 h-5" />
                                                </div>
                                                行程路線
                                            </h2>
                                            {!isPreviewMode && (
                                                <button onClick={() => {
                                                    const newItem = { id: Date.now(), time: '10:00', activity: '新行程', note: '', link: '' };
                                                    updateSchedule(day.id, [...day.schedule, newItem]);
                                                }} className="bg-indigo-50 text-indigo-600 px-3 py-1.5 rounded-full text-sm font-bold hover:bg-indigo-100 flex items-center gap-1">
                                                    <Icons.Plus className="w-4 h-4" /> 新增
                                                </button>
                                            )}
                                        </div>

                                        {/* Timeline */}
                                        <div className="relative border-l-2 border-slate-100 ml-3 md:ml-4 space-y-10 pb-4">
                                            {day.schedule.map((item, idx) => (
                                                <div key={item.id} className="relative pl-8 md:pl-10 group">
                                                    {/* Timeline Dot */}
                                                    <div className={`absolute -left-[9px] top-1.5 w-4 h-4 rounded-full border-4 border-white shadow-sm ${idx % 2 === 0 ? 'bg-indigo-500' : 'bg-emerald-400'}`}></div>

                                                    <div className="flex flex-col md:flex-row md:items-start gap-4">
                                                        {/* Time Input */}
                                                        <div className="w-20 pt-1 shrink-0">
                                                            {!isPreviewMode ? (
                                                                <input value={item.time} onChange={(e) => {
                                                                    const newSchedule = day.schedule.map(s => s.id === item.id ? { ...s, time: e.target.value } : s);
                                                                    updateSchedule(day.id, newSchedule);
                                                                }} className="font-bold text-indigo-600 bg-transparent w-full focus:outline-none" placeholder="00:00" />
                                                            ) : (
                                                                <span className="font-bold text-indigo-600">{item.time}</span>
                                                            )}
                                                        </div>

                                                        {/* Content */}
                                                        <div className="flex-grow space-y-2">
                                                            {!isPreviewMode ? (
                                                                <input value={item.activity} onChange={(e) => {
                                                                    const newSchedule = day.schedule.map(s => s.id === item.id ? { ...s, activity: e.target.value } : s);
                                                                    updateSchedule(day.id, newSchedule);
                                                                }} className="text-xl font-bold text-slate-800 bg-transparent w-full focus:outline-none placeholder-slate-300" placeholder="行程標題" />
                                                            ) : (
                                                                <h3 className="text-xl font-bold text-slate-800">
                                                                    {item.link ? (
                                                                        <a href={item.link} target="_blank" rel="noopener noreferrer" className="hover:text-indigo-600 hover:underline decoration-indigo-300 decoration-2 underline-offset-4 transition-colors flex items-center gap-1 w-fit">
                                                                            {item.activity}
                                                                            <Icons.ExternalLink className="w-4 h-4 text-slate-400" />
                                                                        </a>
                                                                    ) : item.activity}
                                                                </h3>
                                                            )}

                                                            {/* Bubble Note */}
                                                            <div className="relative">
                                                                {!isPreviewMode ? (
                                                                    <div className="flex items-center gap-2">
                                                                        <input value={item.note || ''} onChange={(e) => {
                                                                            const newSchedule = day.schedule.map(s => s.id === item.id ? { ...s, note: e.target.value } : s);
                                                                            updateSchedule(day.id, newSchedule);
                                                                        }} className="bg-slate-100 text-slate-600 px-4 py-2 rounded-xl text-sm w-full focus:outline-none focus:ring-2 focus:ring-indigo-100 transition-all" placeholder="添加備註 (例如: 5:00 出發)" />
                                                                        
                                                                        <input value={item.link} onChange={(e) => {
                                                                            const newSchedule = day.schedule.map(s => s.id === item.id ? { ...s, link: e.target.value } : s);
                                                                            updateSchedule(day.id, newSchedule);
                                                                        }} className="w-24 text-xs text-slate-400 bg-transparent border-b border-transparent focus:border-indigo-200 outline-none" placeholder="連結..." />
                                                                        
                                                                        <button onClick={() => {
                                                                            const newSchedule = day.schedule.filter(s => s.id !== item.id);
                                                                            updateSchedule(day.id, newSchedule);
                                                                        }} className="text-slate-300 hover:text-red-400 p-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                                                            <Icons.Trash2 className="w-4 h-4" />
                                                                        </button>
                                                                    </div>
                                                                ) : (
                                                                    <div className="flex flex-col items-start gap-1">
                                                                        {item.note && <span className="bg-slate-100 text-slate-600 px-3 py-1.5 rounded-lg text-sm inline-block">{item.note}</span>}
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                {/* Right Column: Sidebar (1/3 width) */}
                                <div className="space-y-6">
                                    
                                    {/* Shopping & Food Card */}
                                    <div className="bg-white rounded-3xl shadow-sm border border-slate-100 p-6 h-fit">
                                        <div className="flex justify-between items-center mb-6">
                                            <h3 className="font-bold text-slate-700 flex items-center gap-2">
                                                <Icons.ShoppingBag className="w-5 h-5 text-orange-400" /> 購物清單
                                            </h3>
                                            {!isPreviewMode && (
                                                <button onClick={() => updateShopping(day.id, [...day.shopping, { id: Date.now(), name: '', location: '' }])} 
                                                    className="text-indigo-600 hover:bg-indigo-50 p-1 rounded-full">
                                                    <Icons.Plus className="w-5 h-5" />
                                                </button>
                                            )}
                                        </div>
                                        <div className="space-y-3">
                                            {day.shopping.length === 0 && <p className="text-xs text-slate-400 text-center py-4">暫無購物計畫</p>}
                                            {day.shopping.map(shop => (
                                                <div key={shop.id} className="bg-slate-50 p-3 rounded-xl border border-slate-100 group">
                                                    {!isPreviewMode ? (
                                                        <>
                                                            <div className="flex justify-between items-start">
                                                                <input value={shop.name} onChange={(e) => {
                                                                    const newShopping = day.shopping.map(s => s.id === shop.id ? { ...s, name: e.target.value } : s);
                                                                    updateShopping(day.id, newShopping);
                                                                }} className="font-bold text-slate-700 bg-transparent w-full focus:outline-none border-b border-transparent focus:border-indigo-200" placeholder="店家名稱" />
                                                                <button onClick={() => updateShopping(day.id, day.shopping.filter(s => s.id !== shop.id))} 
                                                                    className="text-slate-300 hover:text-red-400 opacity-0 group-hover:opacity-100">
                                                                    <Icons.Trash2 className="w-4 h-4" />
                                                                </button>
                                                            </div>
                                                            <input value={shop.location} onChange={(e) => {
                                                                const newShopping = day.shopping.map(s => s.id === shop.id ? { ...s, location: e.target.value } : s);
                                                                updateShopping(day.id, newShopping);
                                                            }} className="text-xs text-slate-500 bg-transparent w-full focus:outline-none mt-1" placeholder="備註/位置" />
                                                        </>
                                                    ) : (
                                                        <div>
                                                            <div className="font-bold text-slate-700 text-sm flex items-center gap-1">
                                                                {shop.name} 
                                                                {shop.name.includes('連結') && <Icons.ExternalLink className="w-3 h-3 text-slate-400" />}
                                                            </div>
                                                            <div className="text-xs text-slate-500 mt-0.5">{shop.location}</div>
                                                        </div>
                                                    )}
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Dark Status Card (The "Status Panel") */}
                                    <div className="bg-slate-900 text-white rounded-3xl p-6 shadow-xl relative overflow-hidden">
                                        {/* Decorative Blur */}
                                        <div className="absolute top-0 right-0 w-32 h-32 bg-indigo-500 rounded-full blur-[60px] opacity-20 pointer-events-none"></div>
                                        
                                        <h4 className="text-xs font-bold text-slate-400 mb-6 uppercase tracking-wider flex justify-between">
                                            <span>狀態欄 (可編輯)</span>
                                            {isPreviewMode && <span>{day.date}</span>}
                                        </h4>

                                        <div className="space-y-6 relative z-10">
                                            {/* Weather */}
                                            <div className="flex items-start gap-4">
                                                <div className="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-cyan-400 shrink-0">
                                                    <Icons.Thermometer className="w-5 h-5" />
                                                </div>
                                                <div className="flex-grow">
                                                    <label className="text-xs text-slate-400 block mb-1">氣溫預報</label>
                                                    {!isPreviewMode ? (
                                                        <input value={day.temperature || ''} onChange={(e) => updateDay(day.id, 'temperature', e.target.value)} 
                                                            className="bg-transparent text-lg font-bold text-white w-full focus:outline-none placeholder-slate-600" placeholder="-1°C - 7°C" />
                                                    ) : (
                                                        <div className="text-lg font-bold text-white">{day.temperature}</div>
                                                    )}
                                                </div>
                                            </div>

                                            {/* Transport */}
                                            <div className="flex items-start gap-4">
                                                <div className="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-indigo-400 shrink-0">
                                                    <Icons.Train className="w-5 h-5" />
                                                </div>
                                                <div className="flex-grow">
                                                    <label className="text-xs text-slate-400 block mb-1">主要交通</label>
                                                    {!isPreviewMode ? (
                                                        <div className="flex flex-col gap-1">
                                                            <input value={day.transport || ''} onChange={(e) => updateDay(day.id, 'transport', e.target.value)} 
                                                                className="bg-transparent text-lg font-bold text-white w-full focus:outline-none placeholder-slate-600" placeholder="交通工具" />
                                                            <select value={day.ticketType} onChange={(e) => updateDay(day.id, 'ticketType', e.target.value)}
                                                                className="bg-slate-800 text-xs text-slate-300 rounded px-2 py-1 outline-none border-none w-fit">
                                                                <option value="IC Card">IC Card</option>
                                                                <option value="Ticket">Ticket</option>
                                                                <option value="Pass">Pass</option>
                                                            </select>
                                                        </div>
                                                    ) : (
                                                        <div>
                                                            <div className="text-lg font-bold text-white">{day.transport}</div>
                                                            <div className="text-xs text-slate-400 mt-1 bg-slate-800 px-2 py-0.5 rounded w-fit">{day.ticketType}</div>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>

                                            {/* Accommodation */}
                                            <div className="flex items-start gap-4">
                                                <div className="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-rose-400 shrink-0">
                                                    <Icons.Moon className="w-5 h-5" />
                                                </div>
                                                <div className="flex-grow">
                                                    <label className="text-xs text-slate-400 block mb-1">住宿地點</label>
                                                    {!isPreviewMode ? (
                                                        <input value={day.accommodation || ''} onChange={(e) => updateDay(day.id, 'accommodation', e.target.value)} 
                                                            className="bg-transparent text-lg font-bold text-white w-full focus:outline-none placeholder-slate-600" placeholder="飯店名稱" />
                                                    ) : (
                                                        <div className="text-lg font-bold text-white">{day.accommodation}</div>
                                                    )}
                                                </div>
                                            </div>

                                            {/* Notes */}
                                            <div className="pt-4 border-t border-slate-800">
                                                <label className="text-xs text-slate-500 block mb-2">備註事項</label>
                                                {!isPreviewMode ? (
                                                    <textarea value={day.notes} onChange={(e) => updateDay(day.id, 'notes', e.target.value)} 
                                                        className="w-full bg-slate-800/50 text-emerald-400 text-sm rounded-lg p-3 outline-none resize-none h-20 placeholder-slate-600 font-medium" placeholder="備忘錄..." />
                                                ) : (
                                                    <p className="text-sm text-emerald-400 font-medium whitespace-pre-wrap">{day.notes}</p>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
